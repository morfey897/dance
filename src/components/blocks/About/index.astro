---
import About from "./About";
import type { AboutType } from "./types";
import { getIndex } from "../../../utils/md";
import { translateJSON } from "../../../services/translate";

const { lang } = Astro.params;

let contacts = [];
try {
  contacts = await Astro.glob("../../../../content/about/*.md");
} catch (e) {}

const indexAbout = getIndex(contacts);

const fileProps = {
  ...indexAbout?.frontmatter,
  bodyHTML: indexAbout?.compiledContent(),
} as AboutType;

const translation = await translateJSON(
  {
    target: lang,
    content: {
      about: { ...fileProps },
    },
  },
  Astro.request
);

const props = {
  ...fileProps,
  ...translation?.about,
};
---

<About {...props} />
