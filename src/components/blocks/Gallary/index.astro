---
import Gallary from "./Gallary";
import type { GallaryType } from "./types";
import { getIndex, getList } from "../../../utils/md";

let directions = [];
try {
  directions = await Astro.glob("../../../../content/gallary/*.md");
} catch (e) {}

const indexDirection = getIndex(directions);
const list = getList(directions);

const childrenList = list.map((data) => {
  const uid = data.file.match(/\/([^\/]+)\.md?$/)[1];
  const frontmatter = data.frontmatter;
  return {
    uid,
    headline: '',
    subheadline: '',
    bodyHTML: data.compiledContent(),
    ...frontmatter,
  };
});

const { Content } = indexDirection || { Content: () => {} };
const props = {
  ...indexDirection?.frontmatter,
  list: childrenList,
} as GallaryType;

---

<Gallary {...props} client:load>
  <Content />
</Gallary>
