---
import Gallary from "./Gallary";
import type { GallaryType } from "./types";
import { getIndex, getList, sortComparator, getFileName } from "../../../utils/md";

let directions = [];
try {
  directions = await Astro.glob("../../../../content/gallary/*.md");
} catch (e) {}

const indexDirection = getIndex(directions);
const list = getList(directions);

const childrenList = list.sort(sortComparator).map((data) => {
  const uid = getFileName(data);
  const frontmatter = data.frontmatter;
  return {
    uid,
    headline: '',
    subheadline: '',
    bodyHTML: data.compiledContent(),
    ...frontmatter,
  };
});

const props = {
  ...indexDirection?.frontmatter,
  list: childrenList,
  bodyHTML: indexDirection?.compiledContent(),
} as GallaryType;

---

<Gallary {...props} client:load />
