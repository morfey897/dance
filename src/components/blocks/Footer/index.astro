---
import Footer from "./Footer";
import type { FooterType } from "./types";
import { getIndex } from "../../../utils/md";
import { translateJSON } from "../../../services/translate";
const { lang } = Astro.params;

let localBusiness = [];
let navigation = [];
try {
  localBusiness = await Astro.glob("../../../../content/local-business.md");
} catch (e) {}

try {
  navigation = await Astro.glob("../../../../content/navigation.md");
} catch (e) {}

const navigationIndex = getIndex(navigation);
const indexLocalBusiness = getIndex(localBusiness);

const localBusinessProps = { ...indexLocalBusiness?.frontmatter };
const { footer } = navigationIndex?.frontmatter || {};

const translation = await translateJSON(
  {
    target: lang,
    content: {
      localBusiness: localBusinessProps,
      footer: footer,
    },
  },
  Astro.request
);

const props: FooterType = {
  navigation: translation?.footer || footer,
  ...localBusinessProps,
  ...translation?.localBusiness,
};
---

<Footer {...props} />
