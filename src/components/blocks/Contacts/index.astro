---
import { getEnv } from "../../../services/cloudflare";
import Contacts from "./Contacts";
import type { ContactsType } from "./types";
import { getIndex } from "../../../utils/md";

let contacts = [];
let localBusiness = [];
try {
  contacts = await Astro.glob("../../../../content/contacts/*.md");
} catch (e) {}
try {
  localBusiness = await Astro.glob("../../../../content/local-business.md");
} catch (e) {}
const indexContacts = getIndex(contacts);

const props = {
  ...indexContacts?.frontmatter,
  ...(localBusiness || [])[0]?.frontmatter,
  bodyHTML: indexContacts?.compiledContent(),
  google_api_key: getEnv(Astro.request).GOOGLE_API_KEY,
} as ContactsType;
---

<Contacts {...props} client:load />
