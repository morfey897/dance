---
import Schedule from "./Schedule";
import type { ScheduleType } from "./types";
import { getIndex } from "../../../utils/md";
import { translateJSON } from "../../../services/translate";

const { lang } = Astro.params;

let schedule = [];
try {
  schedule = await Astro.glob("../../../../content/schedule/*.md");
} catch (e) {}

const indexDirection = getIndex(schedule);

const scheduleProps = {
  ...indexDirection?.frontmatter,
  bodyHTML: indexDirection?.compiledContent(),
};

const translation = await translateJSON(
  {
    target: lang,
    content: {
      schedule: scheduleProps,
    },
  },
  Astro.request
);

const props = {
  ...scheduleProps,
  ...translation?.schedule,
  lang,
} as ScheduleType;
---

<Schedule {...props} client:visible />
